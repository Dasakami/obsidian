from database import Base

from sqlalchemy import Column, Integer, String, Text, DateTime, ForeignKey, Boolean, LargeBinary

from datetime import datetime

from sqlalchemy.orm import relationship

  

class Entity(Base):

    __tablename__ = "entitiy"

    id = Column(Integer, primary_key=True, index=True)

    title = Column(String, unique=True)

    slug = Column(String, unique=True)

    description = Column(Text, nullable=True)

    entity_type = Column(String)# 'person', 'place', 'event', 'object', 'term', ...

    main_image = Column(LargeBinary)

    # created_by: UUID  # id админа из Auth_Service

    # approved_by: UUID | None  # кто проверил

    is_verified = Column(Boolean, default=False)

    created_at = Column(DateTime, default=datetime.utcnow())

    updated_at = Column(DateTime, default=datetime.utcnow())

  

class Attribute(Base):

    id = Column(Integer, primary_key=True, index=True)

    entity_id = Column(Integer, ForeignKey("entity.id"), nullable=False)

    key = Column(String) # "birth_date", "population", "capital", ...

    value = Column(Text)

    data_type = Column(String)  # 'string', 'int', 'date', 'link'

  

class Relation(Base):

    id = Column(Integer, primary_key=True, index=True)

    source_id = Column(Integer, ForeignKey("source.id"), nullable=False)

    # target_id: UUID  # Entity B

    relation_type = Column(String)# 'born_in', 'part_of', 'founded', 'fought_in', ...

  

class Source(Base):

    id = Column(Integer, primary_key=True, index=True)

    entity_id = Column(Integer, ForeignKey("entity.id"), nullable=False)

    title = Column(String)

    author = Column(String)

    link = Column(LargeBinary)

    verified = Column(Boolean, default=False)

  

class ArticleLink(Base):

    id = Column(Integer, primary_key=True, index=True)

    entity_id = Column(Integer, ForeignKey("entity.id"), nullable=False)

    # article_id: UUID

  

class Media(Base):

    id = Column(Integer, primary_key=True, index=True)

    entity_id = Column(Integer, ForeignKey("entity.id"), nullable=False)

    file_url = Column(LargeBinary)

    media_type = Column(String) # 'image', 'video', 'document'

    caption = Column(String)

  

class Category(Base):

    id = Column(Integer, primary_key=True, index=True)

    name = Column(String)

    description = Column(Text)

    # parent_id: UUID | None